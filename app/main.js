//>>built
define("app/main","dojo/query dojo/dom dojo/dom-class dojo/dom-style dojo/dom-attr esri/graphic ./map ./config dojo-bootstrap/Collapse dojo-bootstrap/Dropdown dojo-bootstrap/Modal dojo-bootstrap/Alert dojo/domReady!".split(" "),function(d,f,n,g,h,p,e,k){var a={};a.citizenRequestLayer=e.addFeatureLayer();a.collapseMenuToggleButton=f.byId("collapseToggleButton");a.startEditAlert=f.byId("startEditAlert");a.sidebar=f.byId("sidebar");a.attributesModal=d("#requestModal");a.requestTypeSelect=d('#requestModal [name\x3d"requesttype"]')[0];
a.severityFieldDomainCodedValuesDict=k.severityFieldDomainCodedValuesDict;a.requestTypeFieldDomainCodedValuesDict=k.requestTypeFieldDomainCodedValuesDict;window.severityDomainLookup=function(b,c,d){return a.severityFieldDomainCodedValuesDict[b]};window.requestTypeDomainLookup=function(b,c,d){return a.requestTypeFieldDomainCodedValuesDict[b]};window.formatPhoneNumber=function(a,c,d){return a?"\x3ca href\x3d'tel:"+a+"'\x3e"+a+"\x3c/a\x3e":""};var l=function(b){0<d(".navbar-collapse.in").length&&(b.stopPropagation(),
a.collapseMenuToggleButton.click())},q=function(b){var c;g.set(a.startEditAlert,"display","");setTimeout(function(){g.set(a.startEditAlert,"display","none")},3E3);a.currentSeverity=b;c=a.map.on("click",function(b){c.remove();a.currentGeometry=b.mapPoint;a.attributesModal.modal("show")})},m=function(){a.currentSeverity=null;a.currentGeometry=null},r=function(){var b={requestreceived:null},c=new Date,e;a.currentSeverity&&a.currentGeometry&&(e=new p(a.currentGeometry),b.severity=parseInt(a.currentSeverity,
10),d("#requestModal input, #requestModal select, #requestModal textarea").forEach(function(a){b[a.name]=a.value}),b.requesttype=parseInt(b.requesttype,10),b.requestdate=Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),0),e.setAttributes(b),m(),a.citizenRequestLayer.applyEdits([e],null,null).then(function(a){}))};a.map=e.createMap("map","bottom-right");a.map.addLayer(a.citizenRequestLayer);a.legend=e.addLegend(a.map);a.geocoder=e.addGeocoder(a.map);
a.locationButton=e.addLocationButton(a.map);(function(){var b=[],c;for(c in a.requestTypeFieldDomainCodedValuesDict)a.requestTypeFieldDomainCodedValuesDict.hasOwnProperty(c)&&b.push('\x3coption value\x3d"'+c+'"\x3e'+a.requestTypeFieldDomainCodedValuesDict[c]+"\x3c/option\x3e");a.requestTypeSelect.innerHTML=b.join("")})();(function(){d(".report-btn-group .dropdown-menu a").on("click",function(a){a.preventDefault();q(h.get(a.target,"data-value"))});d('a[href\x3d"#feedback"]').on("click",function(a){a.preventDefault();
d("#feedbackModal").modal("show")});d(".navbar-collapse a").on("click",function(a){l(a)});d("#basemapDropdown a").on("click",function(b){(b=h.get(b.target,"data-name"))&&a.map&&a.map.setBasemap(b)});d("#sidebarToggleButton").on("click",function(b){a.map.height&&g.set(a.sidebar,"height",a.map.height+"px");n.toggle(window.document.body,"sidebar-open");l(b)});d("#requestModal .btn").on("click",function(b){"Valider"===b.target.innerHTML&&r();a.attributesModal.modal("hide")});d("#feedbackModal .btn").on("click",
function(a){d("#feedbackModal").modal("hide")});a.attributesModal.on("hidden.bs.modal",m)})();return a});